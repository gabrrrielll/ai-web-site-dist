var t=Object.defineProperty,n=(n,i,o)=>((n,i,o)=>i in n?t(n,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[i]=o)(n,"symbol"!=typeof i?i+"":i,o);import{A as i}from"./index-LVaoys46.js";import"./radix-ui-dMZRe3IE.js";import"./react-vendor-jggwe9L9.js";import"./router-DHJQYTBc.js";import"./seo-CxLpKfYs.js";import"./utils-Bhdrgjh4.js";import"./ui-components-BAiaw5Su.js";const o=new class{constructor(){n(this,"cachedConfig",null),n(this,"plansConfig",null),n(this,"isLoading",!1),n(this,"hasTriedLocal",!1)}async loadPlansConfig(){if(this.plansConfig)return this.plansConfig;try{const t=await this.loadSiteConfig();if(t&&t["plans-config"])return this.plansConfig=t["plans-config"],this.plansConfig}catch(t){}return null}async getSiteConfigUrl(){const t=window.location.hostname;return`${i.BASE_URL}${i.ENDPOINTS.WORDPRESS_REST}/${t}`}async loadSiteConfig(){if(this.isLoading)return this.cachedConfig;try{this.isLoading=!0;"undefined"!=typeof window&&window.location.hostname;if("undefined"!=typeof window){const n=localStorage.getItem("site-config");if(n)try{const t=JSON.parse(n);return this.cachedConfig=t,t["plans-config"],t}catch(t){}}const n=await this.getSiteConfigUrl();return await this.loadFromUrlWithRetry(n)}catch(t){}finally{this.isLoading=!1}return null}async loadFromUrlWithRetry(t){for(let i=1;i<=5;i++)try{const n=new AbortController,o=setTimeout(()=>n.abort(),3e4),e=await fetch(t,{cache:"no-store",signal:n.signal,headers:{Accept:"application/json","Content-Type":"application/json"}});if(clearTimeout(o),e.ok){const t=await e.json();return this.cachedConfig=t,t["plans-config"],"undefined"!=typeof window&&localStorage.setItem("site-config",JSON.stringify(t)),t}if(404===e.status)return null;if(i<5){const t=1e3*Math.pow(2,i-1);await new Promise(n=>setTimeout(n,t));continue}return null}catch(n){if(!(i<5))return n.name,null;{const t=1e3*Math.pow(2,i-1);await new Promise(n=>setTimeout(n,t))}}return null}loadSiteConfigSync(){return this.cachedConfig}};export{o as siteConfigService};
