var t=Object.defineProperty,i=(i,n,o)=>((i,n,o)=>n in i?t(i,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[n]=o)(i,"symbol"!=typeof n?n+"":n,o);import{A as n}from"./index-CzdNyRB2.js";import"./radix-ui-dMZRe3IE.js";import"./react-vendor-jggwe9L9.js";import"./router-DHJQYTBc.js";import"./seo-CxLpKfYs.js";import"./utils-Bhdrgjh4.js";import"./ui-components-BAiaw5Su.js";const o=new class{constructor(){i(this,"cachedConfig",null),i(this,"plansConfig",null),i(this,"isLoading",!1),i(this,"hasTriedLocal",!1)}async loadPlansConfig(){if(this.plansConfig)return this.plansConfig;try{const t=await this.loadSiteConfig();if(t&&t["plans-config"])return this.plansConfig=t["plans-config"],this.plansConfig}catch(t){}return null}async getSiteConfigUrl(){const t=window.location.hostname;return`${n.BASE_URL}${n.ENDPOINTS.WORDPRESS_REST}/website/${t}`}async loadSiteConfig(){if(this.isLoading)return this.cachedConfig;try{this.isLoading=!0;"undefined"!=typeof window&&window.location.hostname;if("undefined"!=typeof window){const i=localStorage.getItem("site-config");if(i)try{const t=JSON.parse(i);return this.cachedConfig=t,t["plans-config"],t}catch(t){}}const i=await this.getSiteConfigUrl();return await this.loadFromUrlWithRetry(i)}catch(t){}finally{this.isLoading=!1}return null}async loadFromUrlWithRetry(t){for(let n=1;n<=5;n++)try{const i=new AbortController,o=setTimeout(()=>i.abort(),3e4),e=await fetch(t,{cache:"no-store",signal:i.signal,headers:{Accept:"application/json","Content-Type":"application/json"}});if(clearTimeout(o),e.ok){const t=await e.json();return this.cachedConfig=t,t["plans-config"],"undefined"!=typeof window&&localStorage.setItem("site-config",JSON.stringify(t)),t}if(404===e.status)return null;if(n<5){const t=1e3*Math.pow(2,n-1);await new Promise(i=>setTimeout(i,t));continue}return null}catch(i){if(!(n<5))return i.name,null;{const t=1e3*Math.pow(2,n-1);await new Promise(i=>setTimeout(i,t))}}return null}loadSiteConfigSync(){return this.cachedConfig}};export{o as siteConfigService};
